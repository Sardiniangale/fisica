import numpy as np
import matplotlib.pyplot as plt

t = [
    2.517249, 3.573610, 4.629958, 5.686280, 6.742587, 
    7.798921, 8.855212, 9.911506, 10.967796, 12.024066, 
    13.080341, 14.136583, 15.192815, 16.249049, 17.305299, 
    18.361538, 19.417754, 20.473957, 21.530154, 22.586316, 
    23.642492, 24.698673, 25.754811, 26.810940, 27.867080, 
    28.923203, 29.979318, 31.035416, 32.091496, 33.147564, 
    34.203623, 35.259682, 36.315737, 37.371797, 38.427843, 
    39.483855, 40.539863, 41.595862, 42.651835, 43.707798, 
    44.763789, 45.819749, 46.875699, 47.931645, 48.987589, 
    50.043515, 51.099443, 52.155348, 53.211256, 54.267140, 
    55.323003, 56.378872, 57.434722, 58.490550, 59.546408, 
    60.602220, 61.658023, 62.713816, 63.769613, 64.825371, 
    65.881136, 66.936905, 67.992684, 69.048415, 70.104166, 
    71.159921, 72.215661, 73.271408, 74.327136, 75.382821, 
    76.438475, 77.494130, 78.549790, 79.605467, 80.661144, 
    81.716772, 82.772394, 83.828009, 84.883632, 85.939237, 
    86.994833, 88.050441, 89.106045, 90.161618, 91.217186, 
    92.272705
]

periodo = [
    2.112757, 2.112709, 2.112670, 2.112629, 2.112641, 
    2.112625, 2.112585, 2.112584, 2.112560, 2.112545, 
    2.112517, 2.112474, 2.112466, 2.112484, 2.112489, 
    2.112455, 2.112419, 2.112400, 2.112359, 2.112338, 
    2.112357, 2.112319, 2.112267, 2.112269, 2.112263, 
    2.112238, 2.112213, 2.112178, 2.112148, 2.112127, 
    2.112118, 2.112114, 2.112115, 2.112106, 2.112058, 
    2.112020, 2.112007, 2.111972, 2.111936, 2.111954, 
    2.111951, 2.111910, 2.111896, 2.111890, 2.111870, 
    2.111854, 2.111833, 2.111813, 2.111792, 2.111747, 
    2.111732, 2.111719, 2.111678, 2.111686, 2.111670, 
    2.111615, 2.111596, 2.111590, 2.111555, 2.111523, 
    2.111534, 2.111548, 2.111510, 2.111482, 2.111506, 
    2.111495, 2.111487, 2.111475, 2.111413, 2.111339, 
    2.111309, 2.111315, 2.111337, 2.111354, 2.111305, 
    2.111250, 2.111237, 2.111238, 2.111228, 2.111201, 
    2.111204, 2.111212, 2.111177, 2.111141, 2.111087, 
    2.111033
]


print("plotting")

x = t
y = periodo
yerr = 0.001
xerr = 0.001

# Create figure
fig, ax = plt.subplots(figsize=(10, 6))

# Plot raw data with error bars
ax.errorbar(x, y, yerr=yerr, xerr=xerr, fmt='o', 
           markersize=8, capsize=5, label='raw data')

# Single fit for all points (linear regression)
coefficients = np.polyfit(x, y, 1)
best_fit = np.poly1d(coefficients)
x_fit = np.linspace(min(x)-0.5, max(x)+0.5, 100)
ax.plot(x_fit, best_fit(x_fit), 'r--', 
        label=f'Best Fit: y = {coefficients[0]:.2f}x + {coefficients[1]:.2f}')

# Formatting with adjusted axis ranges
ax.set ( #xlim=(0, 3),  
   #ylim=(0, 3), 
       xlabel='Tempo',
       ylabel='Period',
       title='Tempo vs Period ')
ax.legend()
ax.grid(True, linestyle='--', alpha=0.6)

plt.tight_layout()
plt.show()
